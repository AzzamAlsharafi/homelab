services:
  homarr:
    container_name: homarr
    image: ghcr.io/homarr-labs/homarr:latest
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock # Optional, only if you want docker integration
      - /storage/homarr:/appdata
    environment:
      SECRET_ENCRYPTION_KEY: "${HOMARR_SECRET_ENCRYPTION_KEY}"
      AUTH_PROVIDERS: "oidc"
      AUTH_OIDC_ISSUER: "https://auth.home.alsharafi.dev"
      AUTH_OIDC_CLIENT_SECRET: "${HOMARR_CLIENT_SECRET}"
      AUTH_OIDC_CLIENT_ID: "${HOMARR_CLIENT_ID}"
      AUTH_OIDC_CLIENT_NAME: "Zitadel"
      AUTH_OIDC_FORCE_USERINFO: "true"
      AUTH_OIDC_SCOPE_OVERWRITE: "openid profile email groups"
      AUTH_OIDC_GROUPS_ATTRIBUTE: "groups"
    networks:
      - proxy
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.homarr.rule=Host(`home.alsharafi.dev`)"
      - "traefik.http.services.homarr.loadbalancer.server.port=7575"

networks:
  proxy:
    external: true